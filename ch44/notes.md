# Django ORM QuerySet â€“ 


## ğŸ“Œ What We Studied Today (QuerySet Topic)

* Basic QuerySet operations
* Filtering and excluding data
* Ordering QuerySets
* Slicing QuerySets
* `values()` and `values_list()`
* Set operations: `union`, `intersection`, `difference`
* Combining QuerySets using AND (`&`) and OR (`|`)
* Inspecting generated SQL queries

---

## ğŸ§  What is a QuerySet? (Quick Revision)

A **QuerySet** is a lazy collection of database queries written in Python.

* QuerySets are part of **Django ORM**
* Database hit happens **only when evaluated**
* QuerySets can be filtered, combined, and reused

---

## 1ï¸âƒ£ `all()` â€“ Fetch All Records

```python
Student.objects.all()
```

### Meaning

* Retrieves **all rows** from the table

### Real-Life Example

* Admin viewing the entire student list

---

## 2ï¸âƒ£ `filter()` â€“ Select Matching Records

```python
Student.objects.filter(city="bokaro")
```

### Meaning

* Returns records that **match the condition**

### Real-Life Example

* Students from a specific city

---

## 3ï¸âƒ£ `exclude()` â€“ Exclude Matching Records

```python
Student.objects.exclude(city="bokaro")
```

### Meaning

* Returns records **except those matching the condition**

### Real-Life Example

* Students not belonging to a city

---

## 4ï¸âƒ£ `order_by()` â€“ Sort QuerySet

```python
Student.objects.order_by('marks')
Student.objects.order_by('-marks')
```

### Meaning

* Sorts records in ascending or descending order

### Real-Life Example

* Ranking students by marks

---

### Random Ordering

```python
Student.objects.order_by('?')
```

* Returns records in random order
* âŒ Expensive for large tables

---

## 5ï¸âƒ£ `reverse()` â€“ Reverse Order

```python
Student.objects.order_by('name').reverse()
```

### Meaning

* Reverses the existing order

---

## 6ï¸âƒ£ Slicing QuerySets (LIMIT)

```python
Student.objects.order_by('name')[0:5]
```

### Meaning

* Fetches limited records

### Real-Life Example

* Top 5 students

---

## 7ï¸âƒ£ `values()` â€“ Dictionary Output

```python
Student.objects.values()
Student.objects.values('name', 'city')
```

### Meaning

* Returns data as **list of dictionaries**

### Use Case

* API responses
* JSON serialization

---

## 8ï¸âƒ£ `values_list()` â€“ Tuple Output

```python
Student.objects.values_list()
Student.objects.values_list('id', 'name')
```

### Meaning

* Returns data as **tuples**

---

### Named Tuples

```python
Student.objects.values_list('id', 'name', named=True)
```

### Meaning

* Access values using attributes (`row.id`, `row.name`)

---

## 9ï¸âƒ£ QuerySet Set Operations

> These work only when QuerySets have **same number and type of fields**.

---

### ğŸ”¹ `union()` â€“ Combine Unique Records

```python
qs1.union(qs2)
```

### Real-Life Example

* Combine student and teacher names into one list

---

### ğŸ”¹ `union(all=True)` â€“ Keep Duplicates

```python
qs1.union(qs2, all=True)
```

---

### ğŸ”¹ `intersection()` â€“ Common Records

```python
qs1.intersection(qs2)
```

### Real-Life Example

* Names common in both tables

---

### ğŸ”¹ `difference()` â€“ Unique to One QuerySet

```python
qs2.difference(qs1)
```

---

## ğŸ”Ÿ Combining QuerySets Using AND / OR

### AND Condition

```python
Student.objects.filter(name="rohit", city="ranchi")
```

Equivalent to:

```python
Student.objects.filter(name="rohit") & Student.objects.filter(city="ranchi")
```

---

### OR Condition

```python
Student.objects.filter(name="rohit") | Student.objects.filter(city="ranchi")
```

---

## ğŸ” Inspecting SQL Query (Advanced)

```python
print(all_data.query)
```

### Meaning

* Shows actual SQL generated by ORM
* Useful for debugging & optimization

---

## âš ï¸ Important Notes

* QuerySets are **lazy**
* Chaining does NOT hit DB immediately
* Avoid `order_by('?')` in production
* Prefer `values()` for APIs

---

## ğŸ¯ Interview-Ready Summary

> â€œQuerySets are a core part of Django ORM that allow developers to retrieve, filter, and manipulate database records using Python. They are lazy, chainable, and database-agnostic.â€

---

## ğŸ§  Key Takeaways (Quick Revision)

* QuerySet is part of Django ORM
* `filter()` includes, `exclude()` removes
* `values()` â†’ dict, `values_list()` â†’ tuple
* QuerySets support set operations
* SQL can be inspected using `.query`

---

âœ… These notes give you **strong practical and conceptual command over Django ORM QuerySets**
