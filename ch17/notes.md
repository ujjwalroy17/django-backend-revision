# ðŸ“˜ Django Models & Database Migrations (ch17)

## ðŸ“Œ Topic Covered

- Model and Create Database Table in Django

---

## ðŸ”¹ What is a Django Model?

A Django Model is a Python class that represents a database table.
Each attribute of the model corresponds to a column in the database table, and each instance of the model represents a row.

### In Simple Words
- **Model** â†’ Database Table
- **Model Field** â†’ Table Column
- **Model Object** â†’ Table Row

### Example:
```python
def Profile(models.Model):
    name = models.CharField(max_length=70)
```
This creates a database table with a column named `name`.

---

## ðŸ”¹ What is Django ORM (Object Relational Mapping)?

django ORM allows developers to interact with the database using Python code instead of writing raw SQL queries.

### ORM:
- Converts Python code into SQL
- Executes queries automatically
- Returns results as Python objects

### Example:
```python
def Profile.objects.create(name="Ujjwal")
```
Behind the scenes, Django converts this into an SQL `INSERT` query.

---

## ðŸ”¹ Benefits of Models & ORM:
- No raw SQL required
- Database-independent
 - Secure (prevents SQL injection)
- Easy migrations 
- Clean and readable code 
 
---
 
## ðŸ”¹ Initial Model Creation:
django models.py file:
```python 
fro m django.db import models 
def class Profile(models.Model):  
    Name = models.CharField(max_length=70)  
    email = models.EmailField(max_length=255)  
    city = models.CharField(max_length=70)  
    roll = models.IntegerField()```
```


## Creating Migration File
```bash
python manage.py makemigrations
```

**Output:**
```bash
`student/migrations/0001_initial.py`
```
---

## Viewing SQL Generated by Django
```bash
python manage.py sqlmigrate student 0001
```

*This shows the SQL query Django will execute to create the table.*

---

## Applying Migration (Creating Table)
```bash
python manage.py migrate
```

**This command:**
- Creates database tables
- Applies all pending migrations

---

## Modifying Model (Adding New Field)
### Case 1: Adding a Non-Nullable Field (Without Default)
```python
type = models.CharField(max_length=70)
```
*Error occurs:*
> It is impossible to add a non-nullable field without specifying a default.

**Solution 1: Provide One-Time Default**
- Django asks for a default value.
- Value is applied to existing rows only.
- Example:
  ```python 
  'CPR'
  ```
---
## ðŸ”¹ Modifying Model (Using Default in Model)
### Case 2: Define Default in models.py
```python
description = models.CharField(max_length=70, default='nothing')
```


Run the following commands:

```bash
python manage.py makemigrations
python manage.py migrate
```

*Note:* No prompt appears because Django knows how to populate existing rows.

---

## ðŸ”¹ Migration Workflow Summary
- **Create / modify model**
- **Run `makemigrations`**
- **Review SQL using `sqlmigrate` (optional)**
- **Apply changes using `migrate`**

---

## ðŸ”¹ Important Notes
- `makemigrations` â†’ creates migration files
- `migrate` â†’ applies changes to database
- Adding non-nullable fields requires a default value
- Django tracks every schema change safely

---

## ðŸ”¹ One-Line Interview Definitions
- **Model:**  
  A Django Model is a Python class that represents a database table.
- **ORM:**  
  Django ORM allows database operations using Python objects instead of SQL queries.